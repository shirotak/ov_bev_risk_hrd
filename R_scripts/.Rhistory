wtdat1$status = data[data[,cat]==1,]$Rec
survdat0 <- res.akm[res.akm$variable==0,]
wtdat0 <- data[data[,cat]==0,]
wtdat0$time = data[data[,cat]==0,duration]
wtdat0$status <-data[data[,cat]==0,]$Rec
tau= min(c(max(wtdat1$time),max(wtdat0$time)))
rmst1akme_1 <- rmst1_AKME(survdata =survdat1,wtdata =wtdat1,tau=tau)
rmst1akme_0 <- rmst1_AKME(survdata =survdat0,wtdata =wtdat0,tau=tau)
rmst1akme_1$rmst[1:2]
rmst1akme_0$rmst[1:2]
armst <- ARMST_diff(rmst_trt = rmst1akme_1$rmst[1],
rmst_ctrl = rmst1akme_0$rmst[1],
rmst_var_trt = rmst1akme_1$rmst.var,
rmst_var_ctrl = rmst1akme_0$rmst.var)
add2=armst$rmst.diff.result
row.names(add2)=cat
dfw2= add2
add3=armst$rmst.ratio.result
row.names(add3)=cat
dfw3= add3
add5=t( data.frame(rmst1akme_1$rmst, rmst1akme_0$rmst))
row.names(add5)=c( paste0(cat,'_arm1'),paste0(cat,'_arm0'))
dfw5=add5
## repeat
cat='Stage34'
covs=c('Bev','Optimal','Age_high','Serous')
# unadjusted
rmst_result_sub1_unadj =rmst2(data[,duration],data$Rec,data[,cat])
add1=t(as.data.frame( rmst_result_sub1_unadj$unadjusted.result[1,] ))
row.names(add1)=cat
dfw1= rbind(dfw1,add1)
add0=t( data.frame(rmst_result_sub1_unadj$RMST.arm1$rmst, rmst_result_sub1_unadj$RMST.arm0$rmst))
row.names(add0)=c( paste0(cat,'_arm1'),paste0(cat,'_arm0'))
dfw0= rbind(dfw0,add0)
add4=t(as.data.frame( rmst_result_sub1_unadj$unadjusted.result[2,] ))
row.names(add4)=cat
dfw4= rbind(dfw4,add4)
# adjusted
Pr1 <- glm( Stage34 ~ Bev + Optimal + Age_high+ Serous,
data=data,family=binomial(link = "logit"))$fitted.values
W <- ( data[,cat]==1) * (1/Pr1) +( data[,cat]==0) * (1)/(1-Pr1)
res.akm <- ipw.survival(times=data[,duration],failures=data$Rec,
variable= data[,cat], weights=W)$table.surv
data$W <- W
survdat1 <- res.akm[res.akm$variable==1,]
wtdat1 <- data[data[,cat]==1,]
wtdat1$time =data[data[,cat]==1,duration]
wtdat1$status = data[data[,cat]==1,]$Rec
survdat0 <- res.akm[res.akm$variable==0,]
wtdat0 <- data[data[,cat]==0,]
wtdat0$time = data[data[,cat]==0,duration]
wtdat0$status <-data[data[,cat]==0,]$Rec
tau= min(c(max(wtdat1$time),max(wtdat0$time)))
rmst1akme_1 <- rmst1_AKME(survdata =survdat1,wtdata =wtdat1,tau=tau)
rmst1akme_0 <- rmst1_AKME(survdata =survdat0,wtdata =wtdat0,tau=tau)
armst <- ARMST_diff(rmst_trt = rmst1akme_1$rmst[1],
rmst_ctrl = rmst1akme_0$rmst[1],
rmst_var_trt = rmst1akme_1$rmst.var,
rmst_var_ctrl = rmst1akme_0$rmst.var)
add2=armst$rmst.diff.result
row.names(add2)=cat
dfw2= rbind(dfw2,add2)
add3=armst$rmst.ratio.result
row.names(add3)=cat
dfw3= rbind(dfw3,add3)
add5=t( data.frame(rmst1akme_1$rmst, rmst1akme_0$rmst))
row.names(add5)=c( paste0(cat,'_arm1'),paste0(cat,'_arm0'))
dfw5= rbind(dfw5,add5)
## repeat
cat='Optimal'
covs=c('Bev','Stage34','Age_high','Serous')
# unadjusted
rmst_result_sub1_unadj =rmst2(data[,duration],data$Rec,data[,cat])
add1=t(as.data.frame( rmst_result_sub1_unadj$unadjusted.result[1,] ))
row.names(add1)=cat
dfw1= rbind(dfw1,add1)
add0=t( data.frame(rmst_result_sub1_unadj$RMST.arm1$rmst, rmst_result_sub1_unadj$RMST.arm0$rmst))
row.names(add0)=c( paste0(cat,'_arm1'),paste0(cat,'_arm0'))
dfw0= rbind(dfw0,add0)
add4=t(as.data.frame( rmst_result_sub1_unadj$unadjusted.result[2,] ))
row.names(add4)=cat
dfw4= rbind(dfw4,add4)
# adjusted
Pr1 <- glm( Optimal ~ Bev + Stage34 + Age_high + Serous,
data=data,family=binomial(link = "logit"))$fitted.values
W <- ( data[,cat]==1) * (1/Pr1) +( data[,cat]==0) * (1)/(1-Pr1)
res.akm <- ipw.survival(times=data[,duration],failures=data$Rec,
variable= data[,cat], weights=W)$table.surv
data$W <- W
survdat1 <- res.akm[res.akm$variable==1,]
wtdat1 <- data[data[,cat]==1,]
wtdat1$time =data[data[,cat]==1,duration]
wtdat1$status = data[data[,cat]==1,]$Rec
survdat0 <- res.akm[res.akm$variable==0,]
wtdat0 <- data[data[,cat]==0,]
wtdat0$time = data[data[,cat]==0,duration]
wtdat0$status <-data[data[,cat]==0,]$Rec
tau= min(c(max(wtdat1$time),max(wtdat0$time)))
rmst1akme_1 <- rmst1_AKME(survdata =survdat1,wtdata =wtdat1,tau=tau)
rmst1akme_0 <- rmst1_AKME(survdata =survdat0,wtdata =wtdat0,tau=tau)
armst <- ARMST_diff(rmst_trt = rmst1akme_1$rmst[1],
rmst_ctrl = rmst1akme_0$rmst[1],
rmst_var_trt = rmst1akme_1$rmst.var,
rmst_var_ctrl = rmst1akme_0$rmst.var)
add2=armst$rmst.diff.result
row.names(add2)=cat
dfw2= rbind(dfw2,add2)
add3=armst$rmst.ratio.result
row.names(add3)=cat
dfw3= rbind(dfw3,add3)
add5=t( data.frame(rmst1akme_1$rmst, rmst1akme_0$rmst))
row.names(add5)=c( paste0(cat,'_arm1'),paste0(cat,'_arm0'))
dfw5= rbind(dfw5,add5)
## repeat
cat='Age_high'
covs=c('Bev','Stage34','Optimal','Serous')
# unadjusted
rmst_result_sub1_unadj =rmst2(data[,duration],data$Rec,data[,cat])
add1=t(as.data.frame( rmst_result_sub1_unadj$unadjusted.result[1,] ))
row.names(add1)=cat
dfw1= rbind(dfw1,add1)
add0=t( data.frame(rmst_result_sub1_unadj$RMST.arm1$rmst, rmst_result_sub1_unadj$RMST.arm0$rmst))
row.names(add0)=c( paste0(cat,'_arm1'),paste0(cat,'_arm0'))
dfw0= rbind(dfw0,add0)
add4=t(as.data.frame( rmst_result_sub1_unadj$unadjusted.result[2,] ))
row.names(add4)=cat
dfw4= rbind(dfw4,add4)
# adjusted
Pr1 <- glm( Age_high ~ Bev + Stage34 + Optimal + Serous,
data=data,family=binomial(link = "logit"))$fitted.values
W <- ( data[,cat]==1) * (1/Pr1) +( data[,cat]==0) * (1)/(1-Pr1)
res.akm <- ipw.survival(times=data[,duration],failures=data$Rec,
variable= data[,cat], weights=W)$table.surv
data$W <- W
survdat1 <- res.akm[res.akm$variable==1,]
wtdat1 <- data[data[,cat]==1,]
wtdat1$time =data[data[,cat]==1,duration]
wtdat1$status = data[data[,cat]==1,]$Rec
survdat0 <- res.akm[res.akm$variable==0,]
wtdat0 <- data[data[,cat]==0,]
wtdat0$time = data[data[,cat]==0,duration]
wtdat0$status <-data[data[,cat]==0,]$Rec
tau= min(c(max(wtdat1$time),max(wtdat0$time)))
rmst1akme_1 <- rmst1_AKME(survdata =survdat1,wtdata =wtdat1,tau=tau)
rmst1akme_0 <- rmst1_AKME(survdata =survdat0,wtdata =wtdat0,tau=tau)
armst <- ARMST_diff(rmst_trt = rmst1akme_1$rmst[1],
rmst_ctrl = rmst1akme_0$rmst[1],
rmst_var_trt = rmst1akme_1$rmst.var,
rmst_var_ctrl = rmst1akme_0$rmst.var)
add2=armst$rmst.diff.result
row.names(add2)=cat
dfw2= rbind(dfw2,add2)
add3=armst$rmst.ratio.result
row.names(add3)=cat
dfw3= rbind(dfw3,add3)
add5=t( data.frame(rmst1akme_1$rmst, rmst1akme_0$rmst))
row.names(add5)=c( paste0(cat,'_arm1'),paste0(cat,'_arm0'))
dfw5= rbind(dfw5,add5)
## repeat
cat='Serous'
covs=c('Bev','Stage34','Optimal','Age_high')
# unadjusted
rmst_result_sub1_unadj =rmst2(data[,duration],data$Rec,data[,cat])
add1=t(as.data.frame( rmst_result_sub1_unadj$unadjusted.result[1,] ))
row.names(add1)=cat
dfw1= rbind(dfw1,add1)
add0=t( data.frame(rmst_result_sub1_unadj$RMST.arm1$rmst, rmst_result_sub1_unadj$RMST.arm0$rmst))
row.names(add0)=c( paste0(cat,'_arm1'),paste0(cat,'_arm0'))
dfw0= rbind(dfw0,add0)
add4=t(as.data.frame( rmst_result_sub1_unadj$unadjusted.result[2,] ))
row.names(add4)=cat
dfw4= rbind(dfw4,add4)
# adjusted
Pr1 <- glm( Serous ~ Bev + Stage34 + Optimal + Age_high,
data=data,family=binomial(link = "logit"))$fitted.values
W <- ( data[,cat]==1) * (1/Pr1) +( data[,cat]==0) * (1)/(1-Pr1)
res.akm <- ipw.survival(times=data[,duration],failures=data$Rec,
variable= data[,cat], weights=W)$table.surv
data$W <- W
survdat1 <- res.akm[res.akm$variable==1,]
wtdat1 <- data[data[,cat]==1,]
wtdat1$time =data[data[,cat]==1,duration]
wtdat1$status = data[data[,cat]==1,]$Rec
survdat0 <- res.akm[res.akm$variable==0,]
wtdat0 <- data[data[,cat]==0,]
wtdat0$time = data[data[,cat]==0,duration]
wtdat0$status <-data[data[,cat]==0,]$Rec
tau= min(c(max(wtdat1$time),max(wtdat0$time)))
rmst1akme_1 <- rmst1_AKME(survdata =survdat1,wtdata =wtdat1,tau=tau)
rmst1akme_0 <- rmst1_AKME(survdata =survdat0,wtdata =wtdat0,tau=tau)
armst <- ARMST_diff(rmst_trt = rmst1akme_1$rmst[1],
rmst_ctrl = rmst1akme_0$rmst[1],
rmst_var_trt = rmst1akme_1$rmst.var,
rmst_var_ctrl = rmst1akme_0$rmst.var)
add2=armst$rmst.diff.result
row.names(add2)=cat
dfw2= rbind(dfw2,add2)
add3=armst$rmst.ratio.result
row.names(add3)=cat
dfw3= rbind(dfw3,add3)
add5=t( data.frame(rmst1akme_1$rmst, rmst1akme_0$rmst))
row.names(add5)=c( paste0(cat,'_arm1'),paste0(cat,'_arm0'))
dfw5= rbind(dfw5,add5)
# Check
dfw1
dfw4
dfw2
dfw3
dfw0
dfw5
out_prefix
# Write out
write.table(dfw0,paste0(out_prefix,'_unadjusted_raw.tsv'),sep='\t',quote = F,
row.names = T,col.names = NA)
write.table(dfw1,paste0(out_prefix,'_unadjusted_diff.tsv'),sep='\t',quote = F,
row.names = T,col.names = NA)
write.table(dfw4,paste0(out_prefix,'_unadjusted_ratio.tsv'),sep='\t',quote = F,
row.names = T,col.names = NA)
write.table(dfw5,paste0(out_prefix,'_adjusted_raw.tsv'),sep='\t',quote = F,
row.names = T,col.names = NA)
write.table(dfw2,paste0(out_prefix,'_adjusted_diff.tsv'),sep='\t',quote = F,
row.names = T,col.names = NA)
write.table(dfw3,paste0(out_prefix,'_adjusted_ratio.tsv'),sep='\t',quote = F,
row.names = T,col.names = NA)
# R script for RMST analysis
# Ref:https://cran.r-project.org/web/packages/survRM2/vignettes/survRM2-vignette3-2.html
pwd=getwd()
pwd
library(survival)
library(survRM2)
# All
D=read.delim('input/ICON7_all.tsv')
time   = D$PFS
status = D$Rec
arm    = D$Bev
tau=min(max(D$PFS[D$Bev==1]),max(D$PFS[D$Bev==0]))
time=pmin(time,tau)
obj = rmst2(time/30, status = status, arm = arm)
res=obj$unadjusted.result
res
# All
D=read.delim('./input/ICON7_all.tsv')
time   = D$PFS
status = D$Rec
arm    = D$Bev
tau=min(max(D$PFS[D$Bev==1]),max(D$PFS[D$Bev==0]))
time=pmin(time,tau)
obj = rmst2(time/30, status = status, arm = arm)
res=obj$unadjusted.result
res
pdf(file = './R_results/All.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/All_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
## Before
D=read.delim('./input/ICON7_all_before.tsv')
time   = D$PFS
time=pmin(time,54*7)
status = D$Rec
arm    = D$Bev
obj = rmst2(time/30, status = status, arm = arm)
res=obj$unadjusted.result
res
pdf(file = './R_results/All_before.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/All_before_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
## After
D=read.delim('./input/ICON7_all_after.tsv')
time   = D$PFS_r
status = D$Rec
arm    = D$Bev
tau=min(max(D$PFS_r[D$Bev==1]),max(D$PFS_r[D$Bev==0]))
time=pmin(time,tau)
obj = rmst2(time/30, status, arm)
res=obj$unadjusted.result
res
pdf(file = './R_results/All_after.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/All_after_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
# Serous
D=read.delim('./input/ICON7_serous.tsv')
time   = D$PFS
status = D$Rec
arm    = D$Bev
obj = rmst2(time/30, status = status, arm = arm)
res=obj$unadjusted.result
res
pdf(file = '../R_results/Serous_all.pdf',height = 1.7,width = 3.2)
pdf(file = './R_results/Serous_all.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/Serous_all_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
D=read.delim('../input/ICON7_serous.tsv')
time   = D$PFS
D=read.delim('./input/ICON7_serous.tsv')
time   = D$PFS
time=pmin(time,54*7)
status = D$Rec
arm    = D$Bev
tau    = 54*7
obj = rmst2(time/30, status = status, arm = arm,tau = tau/30)
res=obj$unadjusted.result
pdf(file = './R_results/Serous_before.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/Serous_before_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
D=read.delim('./input/ICON7_serous_after.tsv')
time   = D$PFS_r
status = D$Rec
arm    = D$Bev
tau=min(max(D$PFS_r[D$Bev==1]),max(D$PFS_r[D$Bev==0]))
time=pmin(time,tau)
obj = rmst2(time/30, status, arm,tau = tau/30)
res=obj$unadjusted.result
res
pdf(file = './R_results/Serous_after.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/Serou_after_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
# NonSerous
D=read.delim('./input/ICON7_nonserous.tsv')
time   = D$PFS
status = D$Rec
arm    = D$Bev
obj = rmst2(time/30, status = status, arm = arm)
res=obj$unadjusted.result
res
pdf(file = './R_results/NonSerous_all.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/NonSerous_all_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
D=read.delim('./input/ICON7_nonserous.tsv')
time   = D$PFS
time=pmin(time,54*7)
status = D$Rec
arm    = D$Bev
tau    = 54*7
obj = rmst2(time/30, status = status, arm = arm,tau = tau/30)
res=obj$unadjusted.result
res
pdf(file = './R_results/NonSerous_before.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/NonSerous_before_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
D=read.delim('./input/ICON7_nonserous_after.tsv')
time   = D$PFS_r
status = D$Rec
arm    = D$Bev
tau=min(max(D$PFS_r[D$Bev==1]),max(D$PFS_r[D$Bev==0]))
time=pmin(time,tau)
obj = rmst2(time/30, status, arm,tau = tau/30)
res=obj$unadjusted.result
res
pdf(file = './R_results/NonSerous_after.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/NonSerous_after_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
# serous HRD
D=read.delim('../input/ICON7_HRD.tsv')
# serous HRD
D=read.delim('./input/ICON7_HRD.tsv')
time   = D$PFS
status = D$Rec
arm    = D$Bev
obj = rmst2(time/30, status = status, arm = arm)
res=obj$unadjusted.result
res
pdf(file = './R_results/HRD_all.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/HRD_all_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
D=read.delim('./input/ICON7_HRD_before.tsv')
time   = D$PFS
time=pmin(time,54*7)
status = D$Rec
arm    = D$Bev
tau    = 54*7
obj = rmst2(time/30, status = status, arm = arm,tau = tau/30)
res=obj$unadjusted.result
res
pdf(file = './R_results/HRD_before.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/HRD_before_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
D=read.delim('./input/ICON7_HRD_after.tsv')
time   = D$PFS_r
status = D$Rec
arm    = D$Bev
tau=min(max(D$PFS_r[D$Bev==1]),max(D$PFS_r[D$Bev==0]))
time=pmin(time,tau)
obj = rmst2(time/30, status, arm,tau = tau/30)
res=obj$unadjusted.result
res
pdf(file = './R_results/HRD_after.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/HRD_after_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
# nonHRD
D=read.delim('./input/ICON7_nonHRD.tsv')
time   = D$PFS
status = D$Rec
arm    = D$Bev
obj = rmst2(time/30, status = status, arm = arm)
res=obj$unadjusted.result
res
pdf(file = './R_results/NonHRD_all.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/NonHRD_all_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
D=read.delim('./input/ICON7_nonHRD_before.tsv')
time   = D$PFS
time=pmin(time,54*7)
status = D$Rec
arm    = D$Bev
tau    = 54*7
obj = rmst2(time/30, status = status, arm = arm,tau = tau/30)
res=obj$unadjusted.result
res
pdf(file = './R_results/NonHRD_before.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/NonHRD_before_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
D=read.delim('./input/ICON7_nonHRD_after.tsv')
time   = D$PFS_r
status = D$Rec
arm    = D$Bev
tau=min(max(D$PFS_r[D$Bev==1]),max(D$PFS_r[D$Bev==0]))
time=pmin(time,tau)
obj = rmst2(time/30, status, arm,tau = tau/30)
res=obj$unadjusted.result
res
pdf(file = './R_results/NonHRD_after.pdf',height = 1.7,width = 3.2)
par(mar=c(3, 2, 0.5, 0.1))
plot(obj, xlab='', ylab='',
col.RMTL = "skyblue",col = 'black',col.main='white',
cex.sub=1.1,cex.axis=0.8,cex.main=0.1,
mgp=c(1,0.5,0))
dev.off()
write.table(res,'./R_results/NonHRD_after_RMST.tsv',sep='\t',quote = F,
col.names = NA,row.names = T)
